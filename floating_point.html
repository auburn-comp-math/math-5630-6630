
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Floating Point Arithmetic &#8212; Introduction to Numerical Analysis I</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=384b581d" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/tabs.css?v=4c969af8" />
    <link rel="stylesheet" type="text/css" href="_static/proof.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=7f8ff830"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script src="_static/tabs.js?v=3ee01567"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=36754332"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"tex": {"macros": {"cO": "\\mathcal{O}", "fl": ["\\textrm{fl}(#1)", 1], "N": "\\mathbb{N}", "floor": ["\\lfloor#1\\rfloor", 1], "bmat": ["\\left[\\begin{array}"], "emat": ["\\end{array}\\right]"]}}, "options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'floating_point';</script>
    <link rel="icon" href="_static/favicon.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Root Finding" href="root_finding.html" />
    <link rel="prev" title="Before you start" href="index.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
  
    <p class="title logo__title">Introduction to Numerical Analysis I</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Lecture notes</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Floating Point Arithmetic</a></li>
<li class="toctree-l1"><a class="reference internal" href="root_finding.html">Root Finding</a></li>
<li class="toctree-l1"><a class="reference internal" href="interpolation.html">Interpolation</a></li>
<li class="toctree-l1"><a class="reference internal" href="quadrature.html">Numerical Quadrature</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/floating_point.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Floating Point Arithmetic</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#representation-of-real-numbers">Representation of Real Numbers</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#floating-point-numbers">Floating Point Numbers</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#rounding">Rounding</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#arithmetic-operations">Arithmetic Operations</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#error-accumulation-multiplication">Error Accumulation: Multiplication</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#error-accumulation-addition">Error Accumulation: Addition</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">Exercises</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#theoretical-part">Theoretical Part</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#computational-part">Computational Part</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#extended-reading">Extended Reading</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="floating-point-arithmetic">
<h1>Floating Point Arithmetic<a class="headerlink" href="#floating-point-arithmetic" title="Link to this heading">#</a></h1>
<p>In this chapter, we will introduce some basics on the real number system for modern computers and discuss the arithmetic operations of the number system.</p>
<section id="representation-of-real-numbers">
<h2>Representation of Real Numbers<a class="headerlink" href="#representation-of-real-numbers" title="Link to this heading">#</a></h2>
<p>Any nonzero real number <span class="math notranslate nohighlight">\(x\in \mathbb{R}\)</span> can be accurately represented with an infinite sequence of digits. This can be understood as the consequence that rational numbers are <strong>dense</strong> on any interval.</p>
<aside class="margin sidebar">
<p class="sidebar-title"><strong>What does “dense” mean?</strong></p>
<p><strong>Dense</strong> means that between any two distinct real numbers, there is always a rational number. It is a fundamental property of the real number system.</p>
</aside>
<p>Therefore, with the binary representation, we can write</p>
<div class="math notranslate nohighlight">
\[
x = \pm (0.d_1 d_2 d_3\dots d_{t-1} d_t d_{t+1}\dots) \times 2^e,
\]</div>
<p>where <span class="math notranslate nohighlight">\(e\)</span> is an integer exponent and <span class="math notranslate nohighlight">\(d_1=1\)</span>, the other binary digits <span class="math notranslate nohighlight">\(d_i\in \{0, 1\}\)</span>. The mantissa part</p>
<aside class="margin sidebar">
<p class="sidebar-title"><strong>IEEE754 Standard</strong></p>
<p>Note that the IEEE754 standard uses a different representation:</p>
<div class="math notranslate nohighlight">
\[
\pm (1.d_1 d_2 d_3\dots d_{t-1} d_t d_{t+1}\dots) \times 2^e,
\]</div>
<p>which shifts the mantissa to the left by one bit. There are no essential differences between the two representations, and the latter is more common in practice.</p>
</aside>
<div class="math notranslate nohighlight">
\[
0.d_1 d_2 d_3\dots =  \frac{d_1}{2} + \frac{d_2}{2^2} + \frac{d_3}{2^3} + \cdots.
\]</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In order to guarantee the uniqueness of the above representation, we need further assumption that there exists an infinite subset <span class="math notranslate nohighlight">\(S\subset \mathbb{N}\)</span> that <span class="math notranslate nohighlight">\(d_j\neq 1\)</span> for <span class="math notranslate nohighlight">\(j\in S\)</span>. For example, under binary representation</p>
<div class="math notranslate nohighlight">
\[0.111\dots = (0.1)\times 2^1,\]</div>
<p>then we will take the latter representation.</p>
</div>
</section>
<section id="floating-point-numbers">
<h2>Floating Point Numbers<a class="headerlink" href="#floating-point-numbers" title="Link to this heading">#</a></h2>
<p>The floating point numbers generally refer to a set of real numbers with <strong>finite</strong> mantissa length. More precisely, we consider the set of real numbers <span class="math notranslate nohighlight">\(\mathbb{F} = \mathbb{F}(t, e_{\min}, e_{\max})\subset \mathbb{R}\)</span> that</p>
<div class="math notranslate nohighlight">
\[\mathbb{F} := \{x\in \mathbb{R} \mid x = \pm (0.d_1 d_2 d_3\dots d_{t-1} d_t) \times 2^e, d_1 =1,  e_{\min}\le e\le e_{\max}\}\cup \{0\}.\]</div>
<p>It can be seen that there are only finite numbers in <span class="math notranslate nohighlight">\(\mathbb{F}\)</span> with the smallest positive element <span class="math notranslate nohighlight">\(x_{\min} = 2^{e_{\min}-1}\)</span> and the largest element <span class="math notranslate nohighlight">\(x_{\max} = ( 1- 2^{-t} )\times 2^{e_{\max} }\)</span>. Therefore</p>
<div class="math notranslate nohighlight">
\[\mathbb{F}\subset \overline{\mathbb{F}}:= \{ x\in \mathbb{R}\mid x_{\min} \le |x| \le x_{\max}\}\cup \{ 0\}.\]</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The elements in <span class="math notranslate nohighlight">\(\mathbb{F}\)</span> are called normalized. If we  allow <span class="math notranslate nohighlight">\(d_1 = 0\)</span> in the definition of <span class="math notranslate nohighlight">\(\mathbb{F}\)</span>, then the numbers in the set are called denormalized.</p>
</div>
<div class="proof theorem admonition" id="THM-Di-Fl-Nu">
<p class="admonition-title"><span class="caption-number">Theorem 1 </span> (Distribution of Floating Numbers)</p>
<section class="theorem-content" id="proof-content">
<p>For any <span class="math notranslate nohighlight">\(e_{\min} \le e\le e_{\max}\)</span>, the distribution of the floating point number system <span class="math notranslate nohighlight">\(\mathbb{F}\)</span> on interval <span class="math notranslate nohighlight">\([2^{e-1}, 2^e]\)</span> is equidistant with distances of length <span class="math notranslate nohighlight">\(2^{e-t}\)</span>.</p>
</section>
</div><div class="proof admonition" id="proof">
<p>Proof. For any  <span class="math notranslate nohighlight">\(x \in \mathbb{F}\cap [2^{e-1}, 2^e]\)</span>, it can be represented by</p>
<div class="math notranslate nohighlight">
\[x = (0.d_1d_2\dots d_t)\times 2^{e}\]</div>
<p>where <span class="math notranslate nohighlight">\(d_1 = 1\)</span>. The mantissa is equidistantly distributed with distance <span class="math notranslate nohighlight">\(2^{-t}\)</span>, therefore the floating point numbers are equidistantly distributed with distances of length <span class="math notranslate nohighlight">\(2^{e-t}\)</span>.</p>
</div>
<p>To understand the approximation to real numbers by the floating point number system <span class="math notranslate nohighlight">\(\mathbb{F}\)</span>, it is important to consider the maximal relative distance between the numbers in <span class="math notranslate nohighlight">\(\overline{\mathbb{F}}\)</span> and their respective closest element in <span class="math notranslate nohighlight">\(\mathbb{F}\)</span>, which is the following quantity:</p>
<div class="math notranslate nohighlight">
\[\max_{x\in \overline{\mathbb{F}}, x\neq 0}\min_{z\in\mathbb{F}} \frac{|z - x|}{|x|}.\]</div>
<p>The following holds:</p>
<div class="proof theorem admonition" id="THM-Ma-Pr">
<p class="admonition-title"><span class="caption-number">Theorem 2 </span> (Machine Precision)</p>
<section class="theorem-content" id="proof-content">
<div class="math notranslate nohighlight">
\[\max_{x\in \overline{\mathbb{F}}, x\neq 0}\min_{z\in\mathbb{F}} \frac{|z - x|}{|x|}\le  2^{-t}.\]</div>
<p>The number <span class="math notranslate nohighlight">\(\mathrm{u} := 2^{-t}\)</span> is also called rounding unit or machine precision.</p>
</section>
</div><aside class="margin sidebar">
<p class="sidebar-title"></p>
<p>The definition of machine precision has two versions. The formal definition <span class="math notranslate nohighlight">\(2^{-t}\)</span> appears mostly in research literature and numerical packages (LAPACK). In modern programming languages like <code class="docutils literal notranslate"><span class="pre">Python</span></code>, <code class="docutils literal notranslate"><span class="pre">MATLAB</span></code>, <code class="docutils literal notranslate"><span class="pre">C++</span></code>, the machine precision is defined by <span class="math notranslate nohighlight">\(2^{1-t}\)</span> instead. The meaning is the <strong>difference</strong> between one and the next floating point number.</p>
<p>In other words, two versions of machine precision are corresponding to different rounding strategies. For the former, the rounding strategy is to round to the nearest floating point number, while for the latter, the rounding strategy is to round-by-chop.</p>
<p>In practice, it is not necessary to distinguish the two versions of machine precision, since the difference is only a factor of 2.</p>
</aside>
<div class="proof admonition" id="proof">
<p>Proof. Without loss of generality, we only need to consider the positive numbers in <span class="math notranslate nohighlight">\(\overline{\mathbb{F}}\)</span>, then one can represent any nonzero <span class="math notranslate nohighlight">\(x\in [x_{\min}, x_{\max}]\)</span> by</p>
<div class="math notranslate nohighlight">
\[x = (0.d_1 d_2 \dots d_t\dots)\times 2^e\in [2^{e-1}, 2^e].\]</div>
<p>Since the floating point numbers are equidistantly distributed on <span class="math notranslate nohighlight">\([2^{e-1}, 2^e]\)</span> from <a class="reference internal" href="#THM-Di-Fl-Nu">Theorem 1</a>, one can find <span class="math notranslate nohighlight">\(z^{\ast}\in\mathbb{F}\)</span> such that</p>
<div class="math notranslate nohighlight">
\[|z^{\ast} - x| \le \frac{1}{2} 2^{e-t},\]</div>
<p>therefore</p>
<div class="math notranslate nohighlight">
\[\frac{|z^{\ast}- x|}{|x|}\le \frac{1}{2} 2^{e-t} \frac{1}{2^{e-1}} = 2^{-t}.\]</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>On modern computers, the following two floating point number systems</p>
<div class="math notranslate nohighlight">
\[\mathbb{F}_{32} := \mathbb{F}(24, -125, 128),\quad\mathbb{F}_{64} := \mathbb{F}(53, -1021, 1024)\]</div>
<p>are supported, they are often called single precision and double precision, respectively.</p>
</div>
<aside class="margin sidebar">
<p class="sidebar-title"><strong>More About IEEE754 Standard</strong></p>
<p>The IEEE754 standard for floating point arithmetic is slightly different from the note. For instance, without <strong>underflow</strong> (all exponent bits are zeros), the standard <code class="docutils literal notranslate"><span class="pre">float32</span></code> is represented as</p>
<div class="math notranslate nohighlight">
\[\pm 1.d_1 d_2\cdots d_{23} \times 2^e\]</div>
<p>where the sign occupies 1 bit, the mantissa occupies 23 bits, and the exponent occupies 8 bits, ranging from <span class="math notranslate nohighlight">\(-126\)</span> to <span class="math notranslate nohighlight">\(127\)</span> instead. The floating number is stored as</p>
<div class="math notranslate nohighlight">
\[\text{sign} \mid e_7 e_6 \cdots e_0 \mid d_1 d_2\cdots d_{23}\]</div>
<p>and <span class="math notranslate nohighlight">\(e = \sum_{j=0}^7 2^{j} e_j - 127\)</span>.</p>
<p>Notice that 8 bits actually can have <span class="math notranslate nohighlight">\(2^8 = 256\)</span> different values, but the IEEE754 standard reserves two special values (all zeros and all ones): <span class="math notranslate nohighlight">\(e = -127\)</span> and <span class="math notranslate nohighlight">\(e = 128\)</span>.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Inf</span></code> is the representation of <span class="math notranslate nohighlight">\(\pm\infty\)</span>, the exponent bits are all ones and the mantissa bits are all zeros.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">NaN</span></code> is the representation of <strong>Not a Number</strong>, the exponent bits are all ones and the mantissa bits are not all zeros. Whether or not the leading bit in mantissa equals to one leads to <strong>quiet</strong> <code class="docutils literal notranslate"><span class="pre">NaN</span></code> or <strong>signaling</strong> <code class="docutils literal notranslate"><span class="pre">NaN</span></code>, respectively.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">subnormal</span></code> numbers occur when the exponent bits are all zeros and the leading mantissa bit is also zero.</p></li>
</ul>
<p>The double precision <code class="docutils literal notranslate"><span class="pre">float64</span></code> under IEEE754 is represented in a similar way, with 11 bits for the exponent and 52 bits for the mantissa.</p>
</aside>
</section>
<section id="rounding">
<h2>Rounding<a class="headerlink" href="#rounding" title="Link to this heading">#</a></h2>
<p>The rounding operation <span class="math notranslate nohighlight">\(\textrm{fl}\)</span> is to map any real numbers of <span class="math notranslate nohighlight">\(\overline{\mathbb{F}}\)</span> into the floating point number system <span class="math notranslate nohighlight">\(\mathbb{F}\)</span> with smallest error. Such rounding operation can be written out explicitly, let <span class="math notranslate nohighlight">\(x = \pm (0.d_1 d_2\dots d_t d_{t+1}\dots )\times 2^e\)</span>, then</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \textrm{fl}(x) =\begin{cases}
        \pm (0.d_1 d_2\dots d_t) \times 2^e &amp; \text{if } d_{t+1} = 0,\\
        \pm (0.d_1 d_2\dots d_t  + 2^{-t}) \times 2^e &amp; \text{if } d_{t+1} = 1.
    \end{cases}
\end{split}\]</div>
<p>It is clear that rounding <span class="math notranslate nohighlight">\(\textrm{fl}\)</span> is monotone and idempotent, which means</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(x\le y \Rightarrow \textrm{fl}(x) \le \textrm{fl}(y)\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(\textrm{fl}(z) = z\)</span> if <span class="math notranslate nohighlight">\(z\in \mathbb{F}\)</span>.</p></li>
</ul>
<div class="proof theorem admonition" id="THM-REL-ERR">
<p class="admonition-title"><span class="caption-number">Theorem 3 </span></p>
<section class="theorem-content" id="proof-content">
<p>For any <span class="math notranslate nohighlight">\(x\in \overline{\mathbb{F}}\)</span>, <span class="math notranslate nohighlight">\(|\textrm{fl}(x) - x| = \min_{z\in \mathbb{F}} |z - x|\)</span>. If <span class="math notranslate nohighlight">\(x\neq 0\)</span>, then</p>
<div class="math notranslate nohighlight">
\[\frac{|\textrm{fl}(x) - x|}{|x|}\le \mathrm{u} = 2^{-t}.\]</div>
</section>
</div><div class="proof admonition" id="proof">
<p>Proof. The special case that <span class="math notranslate nohighlight">\(x = 0\)</span> is trivial, we only consider <span class="math notranslate nohighlight">\(x\in [x_{\min}, x_{\max}]\)</span>, it can be seen that</p>
<div class="math notranslate nohighlight">
\[
    |\textrm{fl}(x) - x| = | (0.d_1d_2\dots \tilde{d}_t) - (0.d_1d_2\dots d_t d_{t+1} \dots )|\times 2^e \le 2^{-(t+1)} \times 2^e,
\]</div>
<p>where <span class="math notranslate nohighlight">\(\tilde{d}_t\)</span> is the rounding bit, therefore</p>
<div class="math notranslate nohighlight">
\[
    \frac{|\textrm{fl}(x) - x|}{|x|} \le \frac{2^{e-(t+1)}}{2^{e-1}} = 2^{-t}.
\]</div>
</div>
<div class="proof corollary admonition" id="COR-REL-ERR">
<p class="admonition-title"><span class="caption-number">Corollary 1 </span></p>
<section class="corollary-content" id="proof-content">
<p>For any <span class="math notranslate nohighlight">\(x\in\overline{\mathbb{F}}\)</span>, <span class="math notranslate nohighlight">\(\textrm{fl}(x) = x(1+\delta)\)</span> with <span class="math notranslate nohighlight">\(|\delta|\le \mathrm{u}\)</span>.</p>
</section>
</div></section>
<section id="arithmetic-operations">
<h2>Arithmetic Operations<a class="headerlink" href="#arithmetic-operations" title="Link to this heading">#</a></h2>
<p>Let <span class="math notranslate nohighlight">\(\mathbb{F} = \mathbb{F}(t, e_{\min}, e_{\max})\)</span> be a given floating point number system and we consider the basic binary operation <span class="math notranslate nohighlight">\(\circ\in \{ +, -, *, /\}\)</span> on <span class="math notranslate nohighlight">\(\mathbb{F}\)</span>, in order to represent the outcome in <span class="math notranslate nohighlight">\(\mathbb{F}\)</span>, a straightforward realization is to define the binary operation <span class="math notranslate nohighlight">\(\boxed{\circ}\)</span> as the following (for the case of division, we assume <span class="math notranslate nohighlight">\(y\neq 0\)</span>):</p>
<div class="math notranslate nohighlight">
\[x \,\boxed{\circ}\, y := \textrm{fl}(x\circ y),\]</div>
<p>then for any <span class="math notranslate nohighlight">\(x, y\in\mathbb{F}\)</span>, if <span class="math notranslate nohighlight">\(x\circ y\in \overline{\mathbb{F}}\)</span>, then <span class="math notranslate nohighlight">\(x \,\boxed{\circ}\, y = (x\circ y)(1 + \delta)\)</span> with <span class="math notranslate nohighlight">\(|\delta| \le \mathrm{u}\)</span> from the <a class="reference internal" href="#COR-REL-ERR">Corollary 1</a>.</p>
<div class="proof remark admonition" id="remark-4">
<p class="admonition-title"><span class="caption-number">Remark 1 </span> (Catastrophic Cancellation)</p>
<section class="remark-content" id="proof-content">
<p>If <span class="math notranslate nohighlight">\(x, y\in\mathbb{R}\)</span>, then the relative error from the following binary operation <span class="math notranslate nohighlight">\(\textrm{fl}(x)\,\boxed{+}\,\textrm{fl}(y)\)</span> can be estimated by</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
\frac{|\textrm{fl}(x)\,\boxed{+}\,\textrm{fl}(y)- (x +  y) |}{|x + y|} &amp;\le \frac{|\textrm{fl}(x)\,\boxed{+}\,\textrm{fl}(y) - (\textrm{fl}(x) +  \textrm{fl}(y)) |}{|x + y|} + \frac{| (\textrm{fl}(x) +  \textrm{fl}(y)) - (x+y)   |}{|x+y|}\\  
&amp;\le\mathrm{u} + (\mathrm{u} +\mathrm{u}^2) \frac{|x|+|y|}{|x+y|}.
\end{aligned}
\end{split}\]</div>
<p>When <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> are close in magnitude but with opposite signs, the cancellation error will be significant. Sometimes the catastrophic cancellation can be avoided in computation.</p>
</section>
</div><aside class="margin sidebar">
<p class="sidebar-title"></p>
<p>It should be noticed that the catastrophic cancellation may not occur if both <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> are floating point numbers. The <strong>Sterbenz</strong> lemma guarantees that the subtraction <span class="math notranslate nohighlight">\(x - y\)</span> is exact if the floating point numbers <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> are close.</p>
</aside>
<div class="proof example admonition" id="ex-catastrophic-cancellation-1">
<p class="admonition-title"><span class="caption-number">Example 1 </span></p>
<section class="example-content" id="proof-content">
<p>The subtraction of two square numbers <span class="math notranslate nohighlight">\(x^2 - y^2\)</span>, where <span class="math notranslate nohighlight">\(x\approx y\in \mathbb{F}\)</span>, since</p>
<div class="math notranslate nohighlight">
\[\textrm{fl}(x^2) - \textrm{fl}(y^2) = x^2 - y^2 + (x^2 + y^2)\delta, \quad |\delta|\le \textrm{u}, \]</div>
<p>it will possibly lead to catastrophic cancellation when there is a rounding error in calculating <span class="math notranslate nohighlight">\(x^2\)</span> or <span class="math notranslate nohighlight">\(y^2\)</span>. However, if we write</p>
<div class="math notranslate nohighlight">
\[ 
x^2 - y^2 = (x - y)(x + y), 
\]</div>
<p>then the catastrophic cancellation can be avoided. Because</p>
<div class="math notranslate nohighlight">
\[
\textrm{fl}(x - y) \boxed{\ast} \textrm{fl}(x + y) =(x - y)(1 + \delta) \boxed{\ast} (x + y)(1 + \delta) = (x^2 - y^2)(1 + \delta)^3,
\]</div>
<p>where <span class="math notranslate nohighlight">\(|\delta|\le \mathrm{u}\)</span>. Therefore the relative error is bounded by <span class="math notranslate nohighlight">\(3\mathrm{u}\)</span>.</p>
</section>
</div><!-- ```{prf:example}
:label: ex-catastrophic-cancellation-2
The evaluation of the logarithmic function $\log(1 + x)$ for tiny $x \in \mathbb{F}$ will lose digits since $\textrm{fl}(1 + x) = 1 + x + O(\textrm{u})$. However, if we write 

$$
\log(1 + x) = x \frac{\log(1 + x)}{(1 + x) - 1}, 
$$

which seems to suffer from catastrophic cancellation in the quotient.  Numerically, the right-hand side becomes

$$
x \boxed{\ast} \left(\log(\textrm{fl}(1 + x))\boxed{/} y \right) = x (1 + O(y)) (1 + \delta) = x (1 + O(\textrm{u})),
$$

where $y = \textrm{fl}(1 + x) \boxed{-} 1$ and the logarithmic function is evaluated by series for $x$ near zero, 

$$
\log(\textrm{fl}(1 + x)) = y + O(y^2).
$$

Therefore, the catastrophic cancellation in the division does not occur.
``` 
-->
<section id="error-accumulation-multiplication">
<h3>Error Accumulation: Multiplication<a class="headerlink" href="#error-accumulation-multiplication" title="Link to this heading">#</a></h3>
<p>For complicated computations on modern computers, the errors from arithmetic operations will accumulate towards the final result (we do not consider techniques such as fused multiply-add (FMA) here). To quantify the accumulation effect, we will need the following lemma.</p>
<div class="proof lemma admonition" id="LEM-ACC">
<p class="admonition-title"><span class="caption-number">Lemma 1 </span></p>
<section class="lemma-content" id="proof-content">
<p>For real numbers <span class="math notranslate nohighlight">\(a_1, a_2, \dots, a_n\)</span> with <span class="math notranslate nohighlight">\(|a_k|\le \delta\)</span> for <span class="math notranslate nohighlight">\(k=1,\dots, n\)</span>, then for <span class="math notranslate nohighlight">\(n\delta &lt; 1\)</span>, the following holds</p>
<div class="math notranslate nohighlight">
\[\prod_{k=1}^n (1 + a_k) = 1 + b_n,\]</div>
<p>where <span class="math notranslate nohighlight">\(|b_n| \le \frac{n\delta}{1 - n\delta}\)</span>.</p>
</section>
</div><div class="proof admonition" id="proof">
<p>Proof. The proof is quite easy with induction. When <span class="math notranslate nohighlight">\(n=1\)</span>, <span class="math notranslate nohighlight">\(|b_1| = |a_1|\le \delta \le \frac{\delta}{1 - \delta}\)</span>. Suppose the claim holds for <span class="math notranslate nohighlight">\(n = m\)</span>, then for <span class="math notranslate nohighlight">\(n = m +1\)</span>, we could see that</p>
<div class="math notranslate nohighlight">
\[
    \prod_{k=1}^{m+1} (1 + a_k) = (1 + b_m) (1 + a_{m+1}) = 1 + b_{m+1}, 
\]</div>
<p>which implies that <span class="math notranslate nohighlight">\(b_{m+1} = b_m + a_{m+1} + a_{m+1}b_m\)</span>, with the given bounds on <span class="math notranslate nohighlight">\(a_{m+1}\)</span> and <span class="math notranslate nohighlight">\(b_m\)</span>, we can estimate</p>
<div class="math notranslate nohighlight">
\[
    |b_{m+1}| = | b_m + a_{m+1} + a_{m+1}b_m | \le \frac{(m+1)\delta}{1 - m\delta} \le \frac{(m+1)\delta}{1 - (m+1)\delta}.
\]</div>
</div>
<p>In the following, we consider the naive floating point product <span class="math notranslate nohighlight">\(P_n\)</span> of <span class="math notranslate nohighlight">\(n\)</span> real numbers <span class="math notranslate nohighlight">\(\{x_j\}_{j=1}^n \subset \mathbb{R}\)</span> with assumption that <span class="math notranslate nohighlight">\((2n-1)\textrm{u} &lt; 1\)</span> by the following iteration</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{cases}
        P_k =\fl{x_1} &amp; k=1,\\
        P_k = P_{k-1}~\boxed{\ast}~ \fl{x_k} &amp; k\ge 2.
    \end{cases}
\end{split}\]</div>
<p>Let <span class="math notranslate nohighlight">\(\fl{x_k} = x_k(1 + \tau_k)\)</span>, then <span class="math notranslate nohighlight">\(|\tau_k|\le \textrm{u}\)</span>. From the <span class="math notranslate nohighlight">\(n\)</span>-th iteration step</p>
<div class="math notranslate nohighlight">
\[
P_n = P_{n-1}~\boxed{\ast}~ \fl{x_n} = \fl{\fl{P_{n-1}}\fl{x_n}} = \fl{P_{n-1}}\fl{x_n}(1 + \delta_n)
\]</div>
<p>such that <span class="math notranslate nohighlight">\(|\delta_n|\le \textrm{u}\)</span>. Since <span class="math notranslate nohighlight">\(P_{n-1}\in \mathbb{F}\)</span>, <span class="math notranslate nohighlight">\(\fl{P_{n-1}} = P_{n-1}\)</span>, then</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
    P_n &amp;= P_{n-1} \fl{x_n}(1 + \delta_n) = P_{n-2} \fl{x_{n-1}}(1 + \delta_{n-1}) (1 + \delta_n) = \cdots \\
    &amp;=  \fl{x_1} \fl{x_2}\cdots \fl{x_n} \prod_{j=2}^n (1 + \delta_j) \\
    &amp;= \prod_{j=1}^n x_j (1 + \tau_j)  \prod_{j=2}^n (1 + \delta_j) \\
    &amp;\le \left(\prod_{j=1}^n x_j \right) (1 + \eta_n),
\end{aligned}
\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(|\eta_n|\le \frac{(2n-1)\textrm{u}}{1 - (2n-1)\textrm{u}}\)</span>.</p>
</section>
<section id="error-accumulation-addition">
<h3>Error Accumulation: Addition<a class="headerlink" href="#error-accumulation-addition" title="Link to this heading">#</a></h3>
<p>For the naive floating point summation <span class="math notranslate nohighlight">\(S_n\)</span> of <span class="math notranslate nohighlight">\(n\)</span> real numbers <span class="math notranslate nohighlight">\(\{x_j \}_{j=1}^n\)</span> by the iteration</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{cases}
    S_k = 0 &amp; k=0,\\
    S_k = S_{k-1}~\boxed{+}~ \fl{x_k} &amp; k\ge 1,
\end{cases}
\end{split}\]</div>
<p>we can carry out a similar analysis. Let <span class="math notranslate nohighlight">\(S^{\ast}_j = \sum_{k=1}^j x_k\)</span> and  <span class="math notranslate nohighlight">\(\fl{x_k} = x_k ( 1 + \tau_k)\)</span> for <span class="math notranslate nohighlight">\(|\tau_k|\le \textrm{u}\)</span>, denote <span class="math notranslate nohighlight">\(\Delta S_j =     S_j^{\ast} - S_j\)</span>, then</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
    \Delta S_j &amp;= S_j^{\ast} - S_j \\&amp;= S_{j}^{\ast} - ( S_{j-1}~\boxed{+}~ \fl{x_j}) \\
    &amp;=  S_{j}^{\ast}  - ( S_{j}^{\ast} - \Delta S_{j-1} + x_j\tau_j)(1 + \delta_j) \\
    &amp;= \Delta S_{j-1}(1 + \delta_j) - \delta_j S_{j}^{\ast} - x_j(\tau_j)(1+\delta_j),
\end{aligned}
\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(|\delta_j|\le \textrm{u}\)</span>. Therefore</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
    |\Delta S_j|&amp;\le |\Delta S_{j-1}|(1 + \textrm{u}) + (\sum_{k=1}^j |x_k|)\textrm{u} + |x_j| \textrm{u}(1 + \textrm{u}) \\
    &amp;\le |\Delta S_{j-2}|(1 + \textrm{u})^2 + (\sum_{k=1}^j |x_k|)\textrm{u}(1+\textrm{u}) + |x_j| \textrm{u}(1 + \textrm{u})^2 \\
    &amp;\quad\quad +  (\sum_{k=1}^{j-1} |x_k|)\textrm{u} + |x_{j-1}| \textrm{u}(1 + \textrm{u})\\
    &amp;\le |\Delta S_{j-3}|(1 + \textrm{u})^3 + (\sum_{k=1}^j |x_k|)\textrm{u}(1+\textrm{u})^2 + |x_j| \textrm{u}(1 + \textrm{u})^3 \\
    &amp;\quad\quad +  (\sum_{k=1}^{j-1} |x_k|)\textrm{u}(1 + \textrm{u}) + |x_{j-1}| \textrm{u}(1 + \textrm{u})^2 \\
    &amp;\quad\quad +  (\sum_{k=1}^{j-2} |x_k|)\textrm{u}+ |x_{j-2}| \textrm{u}(1 + \textrm{u})\\
    &amp;\le  \cdots \\
    &amp;\le  \sum_{l=1}^{j} \left( (\sum_{k=1}^l |x_k|) \textrm{u}(1 + \textrm{u})^{l-1} + |x_{l}|\text{u}(1 + \textrm{u})^{l-1} \right) \\
    &amp; \le \sum_{l=1}^{j} \left( (\sum_{k=1}^j |x_k|) \textrm{u}(1 + \textrm{u})^{l-1} \right) + \left(\sum_{l=1}^j |x_{l}|\right)\text{u}(1 + \textrm{u})^{j-1}\\
    &amp;= \left(\sum_{l=1}^j |x_{l}|\right) ((1 + \textrm{u})^j - 1)
\end{aligned}
\end{split}\]</div>
<p>Using the previous lemma will provide an estimate of <span class="math notranslate nohighlight">\( ((1 + \textrm{u})^j - 1)\)</span> as long as <span class="math notranslate nohighlight">\(j\textrm{u} &lt; 1\)</span>.</p>
</section>
</section>
<section id="exercises">
<h2>Exercises<a class="headerlink" href="#exercises" title="Link to this heading">#</a></h2>
<p>Assume <span class="math notranslate nohighlight">\(n\in \mathbb{N}\)</span> and <span class="math notranslate nohighlight">\(n\textrm{u} &lt; 1\)</span>, let <span class="math notranslate nohighlight">\(\{x_j\}_{j=1}^n\)</span> be a sequence of real numbers, <span class="math notranslate nohighlight">\(\textrm{fl}:\overline{\mathbb{F}}\mapsto \mathbb{F}\)</span> is the rounding operation, <span class="math notranslate nohighlight">\(\textrm{u}\)</span> is the machine epsilon. In the following, we briefly discuss the rounding error for floating point summation (sum reduction).</p>
<div class="proof definition admonition" id="definition-7">
<p class="admonition-title"><span class="caption-number">Definition 1 </span></p>
<section class="definition-content" id="proof-content">
<p>A reduction <span class="math notranslate nohighlight">\(\Pi\)</span> of the floating point summation</p>
<div class="math notranslate nohighlight">
\[
\fl{x_1} ~\boxed{+}~ \fl{x_2} ~\boxed{+}~\cdots ~\boxed{+}~ \fl{x_n}
\]</div>
<p>is an evaluation order for the <span class="math notranslate nohighlight">\(~\boxed{+}~\)</span> operations. For example, <span class="math notranslate nohighlight">\(n = 4\)</span>, then the reduction <span class="math notranslate nohighlight">\(\Pi = (3,1,2)\)</span> is corresponding to the following calculation</p>
<div class="math notranslate nohighlight">
\[
\fl{x_1} ~\boxed{+}~ \fl{x_2} + \underbrace{(\fl{x_3} ~\boxed{+}~ \fl{x_4})}_{=y_1}\to \underbrace{(\fl{x_1} ~\boxed{+}~ \fl{x_2})}_{=y_2} ~\boxed{+}~ y_1 \to \underbrace{(y_2 ~\boxed{+}~ y_1)}_{=y_3},
\]</div>
<p>where <span class="math notranslate nohighlight">\(y_i\)</span> denotes the result of <span class="math notranslate nohighlight">\(i\)</span>-th <span class="math notranslate nohighlight">\(\boxed{+}\)</span> operation in the reduction. Obviously the final summation will be <span class="math notranslate nohighlight">\(y_{n-1}\)</span>. We denote <span class="math notranslate nohighlight">\(T_n(\Pi)\)</span> be the result of floating point summation with reduction order <span class="math notranslate nohighlight">\(\Pi\)</span>.</p>
</section>
</div><section id="theoretical-part">
<h3>Theoretical Part<a class="headerlink" href="#theoretical-part" title="Link to this heading">#</a></h3>
<div class="admonition-problem-1 admonition">
<p class="admonition-title">Problem 1</p>
<p>Prove that the native summation has following error bound</p>
<div class="math notranslate nohighlight">
\[
|T_n(\Pi) - S_n|\le \left( \frac{\textrm{u} n }{1 - \textrm{u} n } \right)\sum_{j=1}^n |x_j|,
\]</div>
<p>where <span class="math notranslate nohighlight">\(S_n = \sum_{j=1}^n x_j\)</span> and <span class="math notranslate nohighlight">\(\Pi = (1,2,\dots, (n-1))\)</span>.</p>
</div>
<div class="admonition-problem-2 admonition">
<p class="admonition-title">Problem 2</p>
<p>Prove that</p>
<div class="math notranslate nohighlight">
\[
\min_{\Pi}|T_n(\Pi) - S_n| \le \left(\frac{ \textup{u} H }{1 - \textup{u} H  }\right)\sum_{j=1}^n |x_j|,
\]</div>
<p>where <span class="math notranslate nohighlight">\(H = \lceil\log_2 n \rceil\)</span> and <span class="math notranslate nohighlight">\(T_n(\Pi)\)</span> is the floating point summation with reduction order <span class="math notranslate nohighlight">\(\Pi\)</span>.</p>
</div>
<div class="admonition-problem-3-horner-s-scheme admonition">
<p class="admonition-title">Problem 3 (Horner’s scheme)</p>
<p>The evaluation of polynomial</p>
<div class="math notranslate nohighlight">
\[
p(x) = a_0 + a_1 x + \dots + a_n x^n
\]</div>
<p>is mostly using Horner’s scheme, which writes the polynomial in ‘nested’ form:</p>
<div class="math notranslate nohighlight">
\[
p(x) = a_0 + x (a_1 + x(a_2 + \dots x(a_{n-1} + x(a_n)))).
\]</div>
<p>Please find an upper bound of the rounding error for this scheme.</p>
</div>
</section>
<section id="computational-part">
<h3>Computational Part<a class="headerlink" href="#computational-part" title="Link to this heading">#</a></h3>
<div class="admonition-problem-4-archimedes-formula-for-pi admonition">
<p class="admonition-title">Problem 4 (Archimedes’ formula for <span class="math notranslate nohighlight">\(\pi\)</span>)</p>
<p>Archimedes’ formula for <span class="math notranslate nohighlight">\(\pi\)</span> is given by calculating the perimeters of regular polygons inscribing and circumscribing a circle of unit diameter. Starting from hexagon, <span class="math notranslate nohighlight">\(P_0 = \frac{1}{\sqrt{3}}\)</span>. The iterative formula can be written in two equivalent forms:</p>
<div class="math notranslate nohighlight">
\[
P_{n+1} = \dfrac{\sqrt{1 + P_n^2} - 1}{P_n},
\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[
P_{n+1} = \dfrac{P_n}{\sqrt{1 + P_n^2}},
\]</div>
<p>where <span class="math notranslate nohighlight">\(P_n\)</span> is the length of each side of the regular polygon with <span class="math notranslate nohighlight">\(6 \times 2^n\)</span> sides. The approximation of <span class="math notranslate nohighlight">\(\pi\)</span> is computed by <span class="math notranslate nohighlight">\(\lim_{n\to\infty} 6\times 2^n\times P_n\)</span>.</p>
<p>Implement both iterative formula and compare the results with the exact value of <span class="math notranslate nohighlight">\(\pi\)</span> at different <span class="math notranslate nohighlight">\(n\)</span>. Explain the difference.</p>
</div>
<div class="admonition-problem-5-pairwise-summation admonition">
<p class="admonition-title">Problem 5 (Pairwise summation)</p>
<p>Based on theoretical part, implement an algorithm for the summation <span class="math notranslate nohighlight">\(\sum_{j=1}^n x_j\)</span> which has <span class="math notranslate nohighlight">\(\mathcal{O}(\textrm{u}\log_2 n)\)</span> rounding error.</p>
</div>
<div class="admonition-problem-6-kahan-compensated-summation admonition">
<p class="admonition-title">Problem 6 (Kahan compensated summation)</p>
<p>Suppose <span class="math notranslate nohighlight">\(a, b\in\mathbb{R}\)</span>, the rounding error for the sum <span class="math notranslate nohighlight">\(s = \fl{\fl{a}+\fl{b}}\)</span> (<span class="math notranslate nohighlight">\(a\ge b\)</span>) can be computed using</p>
<div class="math notranslate nohighlight">
\[
\fl{\fl{s - \fl{a}}-\fl{b}}
\]</div>
<p>Based on this property, one can keep tracking of the rounding error.</p>
<div class="proof algorithm admonition" id="AL-KA-CO-SU">
<p class="admonition-title"><span class="caption-number">Algorithm 1 </span> (Kahan Compensated Summation)</p>
<section class="algorithm-content" id="proof-content">
<p><strong>Inputs</strong> <span class="math notranslate nohighlight">\(\{x_j\}_{j=1}^n\subset \mathbb{R}\)</span></p>
<p><strong>Outputs</strong> <span class="math notranslate nohighlight">\(s_n = \sum_{j=1}^n x_j\)</span></p>
<ol class="arabic simple">
<li><p><span class="math notranslate nohighlight">\(j\gets 1\)</span>, <span class="math notranslate nohighlight">\(e_j \gets 0\)</span>, <span class="math notranslate nohighlight">\(s_j \gets x_j\)</span> //    initialization;</p></li>
<li><p>While <span class="math notranslate nohighlight">\(j &lt; n\)</span>:</p>
<ol class="arabic simple">
<li><p><span class="math notranslate nohighlight">\(j\gets j + 1\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(y_j = x_j - e_{j-1}\)</span> //remove compensated error;</p></li>
<li><p><span class="math notranslate nohighlight">\(s_j = s_{j-1} + y_j\)</span> //perform summation;</p></li>
<li><p><span class="math notranslate nohighlight">\(e_j = (s_j - s_{j-1}) - y_j\)</span> //restore the rounding error;</p></li>
</ol>
</li>
</ol>
</section>
</div><p>Implement the <a class="reference internal" href="#AL-KA-CO-SU">Algorithm 1</a> described above and compare the accuracy with naive summation and pairwise summation with test cases.</p>
</div>
<div class="admonition-problem-7 admonition">
<p class="admonition-title">Problem 7</p>
<p>Suppose the inputs <span class="math notranslate nohighlight">\(\{x_j\}_{j=1}^n\subset \mathbb{R}\)</span> are randomly distributed (say <span class="math notranslate nohighlight">\(x_j\sim U(0,1)\)</span> i.i.d), what is growth of the expected rounding error with respect to total number of inputs <span class="math notranslate nohighlight">\(n\)</span> for the naive summation and pairwise summation? Please provide an explanation of your result. You can use Kahan sum as the accurate result approximately.</p>
</div>
</section>
</section>
<section id="extended-reading">
<h2>Extended Reading<a class="headerlink" href="#extended-reading" title="Link to this heading">#</a></h2>
<p>See <span id="id1">[<a class="reference internal" href="#id4" title="Nicholas J Higham. The accuracy of floating point summation. SIAM Journal on Scientific Computing, 14(4):783–799, 1993.">Higham, 1993</a>, <a class="reference internal" href="#id3" title="Nicholas J Higham and Theo Mary. A new approach to probabilistic rounding error analysis. SIAM Journal on Scientific Computing, 41(5):A2815–A2835, 2019.">Higham and Mary, 2019</a>, <a class="reference internal" href="#id5" title="Jean-Michel Muller. Elementary functions. Springer, 2006.">Muller, 2006</a>]</span>.</p>
<div class="docutils container" id="id2">
<div role="list" class="citation-list">
<div class="citation" id="id4" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">Hig93</a><span class="fn-bracket">]</span></span>
<p>Nicholas J Higham. The accuracy of floating point summation. <em>SIAM Journal on Scientific Computing</em>, 14(4):783–799, 1993.</p>
</div>
<div class="citation" id="id3" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">HM19</a><span class="fn-bracket">]</span></span>
<p>Nicholas J Higham and Theo Mary. A new approach to probabilistic rounding error analysis. <em>SIAM Journal on Scientific Computing</em>, 41(5):A2815–A2835, 2019.</p>
</div>
<div class="citation" id="id5" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">Mul06</a><span class="fn-bracket">]</span></span>
<p>Jean-Michel Muller. <em>Elementary functions</em>. Springer, 2006.</p>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="index.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Before you start</p>
      </div>
    </a>
    <a class="right-next"
       href="root_finding.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Root Finding</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#representation-of-real-numbers">Representation of Real Numbers</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#floating-point-numbers">Floating Point Numbers</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#rounding">Rounding</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#arithmetic-operations">Arithmetic Operations</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#error-accumulation-multiplication">Error Accumulation: Multiplication</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#error-accumulation-addition">Error Accumulation: Addition</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">Exercises</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#theoretical-part">Theoretical Part</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#computational-part">Computational Part</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#extended-reading">Extended Reading</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Yimin Zhong
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>